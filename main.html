<!DOCTYPE html>
<html>

	
<body>
	
<script src="https://aframe.io/releases/0.3.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/AltspaceVR/AltspaceSDK/v2.0.2/dist/altspace.min.js"></script>
<script src="https://cdn.rawgit.com/mrdoob/three.js/r84/build/three.min.js"></script>
<script src="../../dist/altspace.js"></script>
<script src="https://sdk.altvr.com/libs/altspace.js/2.4.0/altspace.min.js"></script>

<!-- set up the scene -->
<a-scene altspace='fullspace:true' sync-system='app: theater; author: greeny3ny'>
	
    <a-assets>

		<a-asset-item id="object" src="https://greeny3ny.github.io/models/objects/theater.obj"></a-asset-item>
		<a-asset-item id="material" src="https://greeny3ny.github.io/models/materials/theater.mtl"></a-asset-item>
		<a-asset-item id="theater" src="https://greeny3ny.github.io/models/dae/theater2.dae"></a-asset-item>
		<a-asset-item id="chair" src="https://greeny3ny.github.io/models/dae/chair.dae"></a-asset-item>
		<img id="curTex" src="https://greeny3ny.github.io/theater/assets/curtain.png">
		<img id="campTex" src="https://greeny3ny.github.io/theater/assets/campfire.png">
		<img id="newUserRoomTex" src="https://greeny3ny.github.io/theater/assets/newuserroom.png">
  	</a-assets>

	<!-- Theater model (OBJ FILE) -->
	<!--<a-entity n-mesh-collider="type:environment" position="37 0 -28" rotation="0 0 0" scale="1 1 1" obj-model="obj: #object; mtl: #material"></a-entity>

	<!-- Theater model -->
	<a-entity n-mesh-collider="type:environment" position="-50 0 0" rotation="0 0 0" scale="1 1 1" collada-model="#theater"></a-entity>
	
	
	<!--<a-entity position="0 1 0" rotation="0 0 0" scale="2 2 2" n-layout-browser="url:https://greeny3ny.github.io/theater/main.html"></a-entity>`-->
	<!--<a-entity position="0 2 0" rotation="0 0 0" scale="3 3 3" n-layout-browser="url:  https://video-jukebox.firebaseapp.com/"></a-entity>
	-->
	<a-box position="0 2 0" scale="1 1 1" color="tomato"></a-box>
	<!--https://video-jukebox.firebaseapp.com/-->
	<!-- Chairs -->
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 0" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 1.5" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 -1.5" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 3" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 -3" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 4.5" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 -4.5" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 6" rotation="0 170 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42 0.5 -6" rotation="0 190 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	
	<a-entity n-mesh-collider="type:hologram" position ="-42.5 0.5 7.5" rotation="0 160 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-42.5 0.5 -7.5" rotation="0 200 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	
	<a-entity n-mesh-collider="type:hologram" position ="-43 0.5 9" rotation="0 150 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-43 0.5 -9" rotation="0 210 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	
	<a-entity n-mesh-collider="type:hologram" position ="-44 0.5 10.5" rotation="0 140 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	<a-entity n-mesh-collider="type:hologram" position ="-44 0.5 -10.5" rotation="0 220 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
	
	<!-- Curtain control text-->
	<a-entity position='15 9 0' rotation='0 0 0' n-text='text: Curtain control;'></a-entity>
	
	<!-- Horizontal Curtain -->
	<!--
	<a-entity id="curt1" geometry="primitive:box" material="shader: flat; src: #curTex" position="-8.5 10 9.5" scale="0.1 18 19" sync="ownOn:moveCurtain1" sync-transform>
		<a-animation begin="moveCurtain1" dur="5000" direction="alternate" easing="linear" attribute="position" from="-8.5 10 9.5" to="-8.5 10 30"  ></a-animation>
	</a-entity>
	
	<a-entity id="curt2" geometry="primitive:box" material="shader: flat; src: #curTex" position="-8.5 10 -9.5" scale="0.1 18 19" sync="ownOn:moveCurtain2" sync-transform>
		<a-animation begin="moveCurtain2" dur="5000" direction="alternate" easing="linear" attribute="position" from="-8.5 10 -9.5" to="-8.5 10 -30"  ></a-animation>
	</a-entity>
	-->
	
	<!-- Vertical Curtain -->
	<a-entity id="curtVert" geometry="primitive:box" material="shader: flat; src: #curTex" position="-58.5 10 0" scale="0.1 20 38" sync="ownOn:moveCurtainVert" sync-transform>
		<a-animation begin="moveCurtainVert" dur="5000" direction="alternate" easing="linear" attribute="position" from="-58.5 10 0" to="-58.5 28 0"  ></a-animation>
	</a-entity>
	
	<!-- Lowering paltform -->
	<a-entity id="loweringPlatform" geometry="primitive:box" n-mesh-collider="type:environment" material="color:red" position="-63 20.5 0" scale="3 0.1 3" sync="ownOn:movePlatform" sync-transform>
		<a-animation begin="movePlatform" dur="5000" direction="alternate" easing="linear" attribute="position" from="-63 20.5 0" to="-63 10 0"  ></a-animation>
	</a-entity>
	
	<a-entity geometry="primitive:box" material="color:black" position="-63 20 0" scale="3 0.2 14">
	</a-entity>
	
	<a-cone color="yellow" scale="1 20 1" position="-60.5 10 0" radius-bottom="2" radius-top="0.01" opacity="0.25"></a-cone>
	
	<!-- Campfire background -->
	<a-entity id="campfireRaise" geometry="primitive:box" material="shader: flat; src: #campTex" position="-63 10 0" scale="0.1 20 38" sync="ownOn:campfireRaise" sync-transform>
		<a-animation begin="campfireRaise" dur="5000" direction="alternate" easing="linear" attribute="position" from="-63 10 0" to="-63 -10 0"  ></a-animation>
	</a-entity>
	
	<!-- New User Room background -->
	<a-entity id="newUserRaise" geometry="primitive:box" material="shader: flat; src: #newUserRoomTex" position="-63.1 9.5 0" scale="0.1 20 38" sync="ownOn:newUserRaise" sync-transform>
		<a-animation begin="newUserRaise" dur="5000" direction="alternate" easing="linear" attribute="position" from="-63.1 10 0" to="-63.1 -10 0"  ></a-animation>
	</a-entity>
	
</a-scene>
 
 
</body>

<script>
	var scene = document.querySelector('a-scene');
	var sim = new altspace.utilities.Simulation();
	var boxGeo = new THREE.BoxGeometry(1, 1, 1);
	var openMat = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
	var closeMat = new THREE.MeshBasicMaterial( { color: 0x0000ff } );
	var redMat = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
	var NUR_Mat = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
	var openBox = new THREE.Mesh(boxGeo, openMat);
	var lowerBox = new THREE.Mesh(boxGeo, closeMat);
	var campfireRaiseBox = new THREE.Mesh(boxGeo, redMat);
	var NUR_RaiseBox = new THREE.Mesh(boxGeo, NUR_Mat);

	openBox.position.set(-36, 9, 0);
	lowerBox.position.set(-36, 9, 1);
	campfireRaiseBox.position.set(-36, 9, 2);
	NUR_RaiseBox.position.set(-36, 9, 3);
	//lowerBox.position.set(-11, 20, 0);

	
	openBox.addEventListener('cursordown', function(){
		//document.querySelector('#curt1').emit('moveCurtain1');
		//document.querySelector('#curt2').emit('moveCurtain2');
		document.querySelector('#curtVert').emit('moveCurtainVert');			
	});
	
	lowerBox.addEventListener('cursordown', function(){
		document.querySelector('#loweringPlatform').emit('movePlatform');
	});
	
	campfireRaiseBox.addEventListener('cursordown', function(){
		document.querySelector('#campfireRaise').emit('campfireRaise');
	});
	
	NUR_RaiseBox.addEventListener('cursordown', function(){
		document.querySelector('#newUserRaise').emit('newUserRaise');
	});
	
	sim.scene.add(openBox);
	sim.scene.add(lowerBox);
	sim.scene.add(campfireRaiseBox);
	sim.scene.add(NUR_RaiseBox);
	
	altspace.getDocument().position.set(0,0,0);
	sim.scene.add(altspace.getDocument());
	//Draw chairs
	//for (var i=0; i<10; i++){
	
		//<a-entity n-mesh-collider="type:hologram" 
		//position ="8 0.5 0" rotation="0 180 0" scale="0.5 0.5 0.5" collada-model="#chair"></a-entity>
		
		//var chair = document.createElement('a-entity');
		
		//chair.setAttribute('n-mesh-collider', 'type:hologram');
		//chair.setAttribute('position', '8 0 ' + (1.5*i));
		//chair.setAttribute('rotation', '0 0 0');
	//	chair.setAttribute('scale', '0.5 0.5 0.5');
	//	chair.setAttribute('collada-model', '#chair');
	
	//	sim.scene.add(chair);
	//}

	
</script>

</html>
